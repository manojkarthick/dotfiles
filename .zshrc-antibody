# ---------------------------------------- #
# Exports and Paths
# ---------------------------------------- #
export PATH="$HOME/bin:/Users/manojkarthickselvakumar/Homebrew/bin:${PATH}:${HOME}/.krew/bin"

# ---------------------------------------- #
#  Oh My ZSH
# ---------------------------------------- #
# ZSH_THEME="gianu"
# DISABLE_AUTO_UPDATE="true"
# plugins=(kubectl helm docker git fzf command-not-found)
# export ZSH="/Users/$USER/.oh-my-zsh"
# source $ZSH/oh-my-zsh.sh

# ---------------------------------------- #
#  Antibody
# ---------------------------------------- #

autoload -Uz compinit
if [ $(date +'%j') != $(stat -f '%Sm' -t '%j' ~/.zcompdump) ]; then
  compinit
else
  compinit -C
fi

source ~/tools/antibody/.zsh_plugins.sh

# ---------------------------------------- #
#  Custom
# ---------------------------------------- #

export HOMEBREW_NO_AUTO_UPDATE="1" 
export DEFAULT_BROWSER="Safari" 
export EDITOR="vim" 
export LANG="en_US.UTF-8" 

# fzf
[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh
export FZF_DEFAULT_OPTS="--height 40% --layout=reverse"

# Online cheatsheet
function cheat(){
	curl "cheat.sh/$1"
}

# Jump to project bookmark
jump() {
  local dir
  dir=$(cat ~/code/.bookmarks| fzf ) &&
  cd "$dir"
  zle reset-prompt
}
zle -N jump

# Open repository in chrome
func repo(){
	if [ -d .git ]; then
  		open -a $DEFAULT_BROWSER $(git remote get-url upstream | sed 's|.git$||g');
  	else
  		echo "Not a git repository!";
  	fi;
}

# Saving initial prompt before timestamp changes
INITIAL_PROMPT=$PROMPT
# Don't show timestamp anymore
function timeoff() {
  # Prompt from theme gianu
  PROMPT=$INITIAL_PROMPT
}
# Show timestamp in prompt header
function timeon() {
  PROMPT='[%*] '$PROMPT
}


# ---------------------------------------- #
#  Aliases
# ---------------------------------------- #

alias bmadd='echo $(pwd) >> /Users/$USER/code/.bookmarks'
alias ignore='function(){ curl -sLw "\n" https://www.gitignore.io/api/$@ ;}'
alias cpwd='pwd|tr -d "\n"|pbcopy'
alias pq='parquet-tools'
alias src="source /Users/$USER/.zshrc"
alias what-role='echo $ASSUMED_ROLE'
alias ecr-login='eval $(aws ecr get-login --region us-east-1 --no-include-email)'


# ---------------------------------------- #
#  Bindkeys
# ---------------------------------------- #

bindkey -e
bindkey '\e\e[C' forward-word
bindkey '\e\e[D' backward-word
bindkey "^j" jump

# ---------------------------------------- #
#  Python and friends
# ---------------------------------------- #

pyenv() {
  eval "$(command pyenv init - zsh --no-rehash)"
  pyenv "$@"
}


# ---------------------------------------- #
#  Golang and related tools
# ---------------------------------------- #

goenv() {
	eval "$(goenv init -)"
	goenv "$@"
}

# ---------------------------------------- #
#  Kube PS1 
# ---------------------------------------- #
source "/Users/$USER/Homebrew/opt/kube-ps1/share/kube-ps1.sh"
function get_cluster_short() {
  echo "$1" | cut -d / -f2
}
export KUBE_PS1_SYMBOL_ENABLE=false
export KUBE_PS1_CLUSTER_FUNCTION=get_cluster_short
export KUBE_PS1_DIVIDER=" : "
export KUBE_PS1_PREFIX="("
export KUBE_PS1_SUFFIX=") "
PROMPT='$(kube_ps1)'$PROMPT


# ---------------------------------------- #
#  NodeJS and related tools
# ---------------------------------------- #
# export NVM_DIR="$HOME/.nvm"
# [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm
